#!/usr/bin/python3
import requests
import json
import sys
query = sys.argv[1]
global api_url_base
global api_key

api_url_base='https://api.shodan.io'
#api_key='?key=[CENSURADO]'

def profile():
  url_account_profile=api_url_base+'/account/profile{}'.format(api_key)
  print(url_account_profile)
  profile=requests.get(url_account_profile)
  print("Status code: {}".format(profile.status_code))
  print(profile.json())

def apiInfo():
  url_apiInfo = api_url_base+'/api-info{}'.format(api_key)
  apiInfo=requests.get(url_apiInfo)
  print(apiInfo.status_code)
  print(apiInfo.json())
  
def subDomain(targetDomain):
  url_domain = api_url_base+'/dns/domain/{}{}'.format(targetDomain,api_key)
  apiDomain=requests.get(url_domain)
  print(apiDomain.status_code)
  print(apiDomain.json())

def search(query):
  url_search = api_url_base+'/shodan/host/search{}&query={}'.format(api_key,query)
  search=requests.get(url_search)
  print("status code: {}".format(search.status_code))
  total=search.json()['total']
  print(search.json())
  exit(1)
  for result in search.json()['matches']:
    print('Target:{}.{} Port:{}'.format(result['hostnames'],result['domains'],result['port']))

  print(total)
  



#profile()
#apiInfo()
targetDomain='fiap.com.br'
subDomain(targetDomain)
#search(query)
  
