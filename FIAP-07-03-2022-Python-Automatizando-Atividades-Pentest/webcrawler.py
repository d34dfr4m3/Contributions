#!/usr/bin/python3
import requests
import sys
from bs4 import BeautifulSoup

url = 'testphp.vulnweb.com'
print("[+] Target: {}".format(url))

if 'http://' not in url:
  print("No protocol detect, testing http or https")
  try:
    check_url='http://'+url
    req = requests.get(check_url)
    #print(req.content)
  except Exception as error:
    check_url = 'https://' + url
    req = requests.get(check_url)


if req.status_code == 200:
  print("[-] Valid URL, starting routine")
  #wordlist = "common.txt"
  wordlist= 'Common-PHP-Filenames.txt'
  f = open(wordlist,'r')
  print("Starting Brute force")
  for word in f:
    brute_url=check_url+"/{}".format(word.replace("\n",""))
    brute_req = requests.get(brute_url)
    if brute_req.status_code == 200:
      print("[-] Valid Path found: {}, status {}, len {}".format(brute_url,brute_req.status_code,len(brute_req.content)))
      data = brute_req.text
      soup = BeautifulSoup(data,"html.parser")
      links = soup.find_all('a')
      for link in links:
        if not str(link.get("href")).startswith('http') and not str(link.get("href")).startswith('www'):
          print("New link:{}".format(link.get('href')))













#print("Status Code: {}".format(req.status_code))
#print("Headers: {}".format(req.headers))
#print("Content lenght {}".format(len(req.content)))







